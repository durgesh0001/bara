!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","lodash"],t):t((e.angular2=e.angular2||{},e.angular2.data=e.angular2.data||{},e.angular2.data.table=e.angular2.data.table||{}),e.ng.core,e.ng.common,e._)}(this,function(e,t,a,n){"use strict";var i=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r},o=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.DataTable=function(){function e(){this.inputData=[],this.sortBy="",this.sortOrder="asc",this.rowsOnPage=1e3,this.activePage=1,this.selectedEntitiesEmitter=new t.EventEmitter,this.selectedEntities=[],this.mustRecalculateData=!1,this.onDataChange=new t.EventEmitter,this.onSortChange=new t.EventEmitter,this.onPageChange=new t.EventEmitter,this.onSelectChange=new t.EventEmitter}return e.prototype.addRemoveSelectedEntity=function(e){this.onSelectChange.emit({}),this.updateSelectedEntities(),this.selectedEntitiesEmitter.emit(this.selectedEntities)},e.prototype.updateSelectedEntities=function(){this.selectedEntities=this.inputData.filter(function(e){return e.__isSelected__})},e.prototype.selectAllRows=function(){this.inputData.forEach(function(e){e.__isSelected__=!0}),this.updateSelectedEntities(),this.selectedEntitiesEmitter.emit(this.selectedEntities)},e.prototype.deselectAllRows=function(){this.inputData.forEach(function(e){e.__isSelected__=!1}),this.updateSelectedEntities(),this.selectedEntitiesEmitter.emit(this.selectedEntities)},e.prototype.getSort=function(){return{sortBy:this.sortBy,sortOrder:this.sortOrder}},e.prototype.setSort=function(e,t){this.sortBy===e&&this.sortOrder===t||(this.sortBy=e,this.sortOrder=t,this.mustRecalculateData=!0,this.onSortChange.emit({sortBy:e,sortOrder:t}))},e.prototype.getPage=function(){return{activePage:this.activePage,rowsOnPage:this.rowsOnPage,dataLength:this.inputData.length}},e.prototype.setPage=function(e,t){this.rowsOnPage===t&&this.activePage===e||(this.activePage=this.activePage!==e?e:this.calculateNewActivePage(this.rowsOnPage,t),this.rowsOnPage=t,this.mustRecalculateData=!0,this.onPageChange.emit({activePage:this.activePage,rowsOnPage:this.rowsOnPage,dataLength:this.inputData.length}))},e.prototype.calculateNewActivePage=function(e,t){var a=(this.activePage-1)*e+1;return Math.ceil(a/t)},e.prototype.ngOnInit=function(){this.inputDataLength=this.inputData.length},e.prototype.ngOnChanges=function(e){e.inputData&&(this.mustRecalculateData=!0,this.ngDoCheck())},e.prototype.addIsSelectedProperty=function(){this.inputData.forEach(function(e){null==e.__isSelected__&&Object.defineProperty(e,"__isSelected__",{value:!1,writable:!0})})},e.prototype.ngDoCheck=function(){(this.mustRecalculateData||this.isInputDataChanged())&&(this.addIsSelectedProperty(),this.inputData=this.inputData||[],this.onPageChange.emit({activePage:this.activePage,rowsOnPage:this.rowsOnPage,dataLength:this.inputData.length}),this.onDataChange.emit({length:this.inputData.length}),this.fillData(),this.mustRecalculateData=!1)},e.prototype.isInputDataChanged=function(){var e=this.inputDataLength!=this.inputData.length;return this.inputDataLength=this.inputData.length,e},e.prototype.fillData=function(){var e=this;this.activePage=this.activePage,this.rowsOnPage=this.rowsOnPage;var t=(this.activePage-1)*this.rowsOnPage,a=this.inputData;a=n.orderBy(a,function(t){var a=t[e.sortBy];return a&&"string"==typeof a||a instanceof String?a.toLowerCase():a},[this.sortOrder]),a=n.slice(a,t,t+this.rowsOnPage),this.data=a},e}(),i([t.Input("mfData"),o("design:type",Array)],e.DataTable.prototype,"inputData",void 0),i([t.Input("mfRowsOnPage"),o("design:type",Object)],e.DataTable.prototype,"rowsOnPage",void 0),i([t.Input("mfActivePage"),o("design:type",Object)],e.DataTable.prototype,"activePage",void 0),i([t.Output("mfSelectedEntities"),o("design:type",Object)],e.DataTable.prototype,"selectedEntitiesEmitter",void 0),e.DataTable=i([t.Directive({selector:"table[mfData]",exportAs:"mfDataTable"})],e.DataTable);var r=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.BootstrapPaginator=function(){function e(){this.rowsOnPageSet=[],this.minRowsOnPage=0}return e.prototype.ngOnChanges=function(e){e.rowsOnPageSet&&(this.minRowsOnPage=n.min(this.rowsOnPageSet))},e}(),r([t.Input("rowsOnPageSet"),c("design:type",Object)],e.BootstrapPaginator.prototype,"rowsOnPageSet",void 0),r([t.Input("mfTable"),c("design:type",e.DataTable)],e.BootstrapPaginator.prototype,"mfTable",void 0),e.BootstrapPaginator=r([t.Component({selector:"mfBootstrapPaginator",template:'\n    <mfPaginator #p [mfTable]="mfTable">\n        <nav class="pagination" *ngIf="p.dataLength > p.rowsOnPage">\n            <li [class.disabled]="p.activePage <= 1" (click)="p.setPage(1)">\n                <a style="cursor: pointer">&laquo;</a>\n            </li>\n            <li *ngIf="p.activePage > 4 && p.activePage + 1 > p.lastPage" (click)="p.setPage(p.activePage - 4)">\n                <a style="cursor: pointer">{{p.activePage-4}}</a>\n            </li>\n            <li *ngIf="p.activePage > 3 && p.activePage + 2 > p.lastPage" (click)="p.setPage(p.activePage - 3)">\n                <a style="cursor: pointer">{{p.activePage-3}}</a>\n            </li>\n            <li *ngIf="p.activePage > 2" (click)="p.setPage(p.activePage - 2)">\n                <a style="cursor: pointer">{{p.activePage-2}}</a>\n            </li>\n            <li *ngIf="p.activePage > 1" (click)="p.setPage(p.activePage - 1)">\n                <a style="cursor: pointer">{{p.activePage-1}}</a>\n            </li>\n            <li class="active">\n                <a style="cursor: pointer">{{p.activePage}}</a>\n            </li>\n            <li *ngIf="p.activePage + 1 <= p.lastPage" (click)="p.setPage(p.activePage + 1)">\n                <a style="cursor: pointer">{{p.activePage+1}}</a>\n            </li>\n            <li *ngIf="p.activePage + 2 <= p.lastPage" (click)="p.setPage(p.activePage + 2)">\n                <a style="cursor: pointer">{{p.activePage+2}}</a>\n            </li>\n            <li *ngIf="p.activePage + 3 <= p.lastPage && p.activePage < 3" (click)="p.setPage(p.activePage + 3)">\n                <a style="cursor: pointer">{{p.activePage+3}}</a>\n            </li>\n            <li *ngIf="p.activePage + 4 <= p.lastPage && p.activePage < 2" (click)="p.setPage(p.activePage + 4)">\n                <a style="cursor: pointer">{{p.activePage+4}}</a>\n            </li>\n            <li [class.disabled]="p.activePage >= p.lastPage" (click)="p.setPage(p.lastPage)">\n                <a style="cursor: pointer">&raquo;</a>\n            </li>\n        </nav>\n        <nav class="pagination pull-right" *ngIf="p.dataLength > minRowsOnPage">\n            <li *ngFor="let rows of rowsOnPageSet" [class.active]="p.rowsOnPage===rows" (click)="p.setRowsOnPage(rows)">\n                <a style="cursor: pointer">{{rows}}</a>\n            </li>\n        </nav>\n    </mfPaginator>\n    '})],e.BootstrapPaginator);var s=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.DefaultSorter=function(){function e(e){var t=this;this.mfTable=e,this.isSortedByMeAsc=!1,this.isSortedByMeDesc=!1,e.onSortChange.subscribe(function(e){t.isSortedByMeAsc=e.sortBy===t.sortBy&&"asc"===e.sortOrder,t.isSortedByMeDesc=e.sortBy===t.sortBy&&"desc"===e.sortOrder})}return e.prototype.sort=function(){this.isSortedByMeAsc?this.mfTable.setSort(this.sortBy,"desc"):this.mfTable.setSort(this.sortBy,"asc")},e}(),s([t.Input("by"),l("design:type",String)],e.DefaultSorter.prototype,"sortBy",void 0),e.DefaultSorter=s([t.Component({selector:"mfDefaultSorter",template:'\n        <a style="cursor: pointer" (click)="sort()" class="text-nowrap">\n            <ng-content></ng-content>\n            <span *ngIf="isSortedByMeAsc" class="glyphicon glyphicon-triangle-top" aria-hidden="true"></span>\n            <span *ngIf="isSortedByMeDesc" class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></span>\n        </a>'}),l("design:paramtypes",[e.DataTable])],e.DefaultSorter);var p=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(a,n){t(a,n,e)}};e.Paginator=function(){function e(e){var t=this;this.injectMfTable=e,this.dataLength=0,this.onPageChangeSubscriber=function(e){t.activePage=e.activePage,t.rowsOnPage=e.rowsOnPage,t.dataLength=e.dataLength,t.lastPage=Math.ceil(t.dataLength/t.rowsOnPage)}}return e.prototype.ngOnChanges=function(e){this.mfTable=this.inputMfTable||this.injectMfTable,this.onPageChangeSubscriber(this.mfTable.getPage()),this.mfTable.onPageChange.subscribe(this.onPageChangeSubscriber)},e.prototype.setPage=function(e){this.mfTable.setPage(e,this.rowsOnPage)},e.prototype.setRowsOnPage=function(e){this.mfTable.setPage(this.activePage,e)},e}(),p([t.Input("mfTable"),g("design:type",e.DataTable)],e.Paginator.prototype,"inputMfTable",void 0),e.Paginator=p([t.Component({selector:"mfPaginator",template:"<ng-content></ng-content>"}),f(0,t.Optional()),g("design:paramtypes",[e.DataTable])],e.Paginator);var h=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r},u=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.RowSelector=function(){function e(e){this.mfTable=e,this.entity=Object,this.isChecked=!1}return e.prototype.ngOnInit=function(){this.getIsChecked()},e.prototype.ngDoCheck=function(){this.getIsChecked()},e.prototype.getIsChecked=function(){this.isChecked=this.entity.__isSelected__},e.prototype.onChange=function(){this.entity.__isSelected__=!this.entity.__isSelected__,this.mfTable.addRemoveSelectedEntity(this.entity)},e}(),h([t.Input(),u("design:type",Object)],e.RowSelector.prototype,"entity",void 0),h([t.Input(),u("design:type",String)],e.RowSelector.prototype,"checkboxId",void 0),e.RowSelector=h([t.Component({selector:"mfRowSelector",template:'\n        <input type="checkbox" id="{{checkboxId}}" [checked]="isChecked" (change)="onChange()" />\n        <label attr.for="{{checkboxId}}"></label>\n        '}),u("design:paramtypes",[e.DataTable])],e.RowSelector);var d=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r},P=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.RowSelectorHead=function(){function e(e){var t=this;this.mfTable=e,this.isChecked=!1,e.onDataChange.subscribe(function(){t.isChecked=!1}),e.onSelectChange.subscribe(function(){t.isChecked=!1})}return e.prototype.onChange=function(e){this.isChecked=!this.isChecked,this.isChecked?this.mfTable.selectAllRows():this.mfTable.deselectAllRows()},e}(),d([t.Input("checkboxId"),P("design:type",String)],e.RowSelectorHead.prototype,"checkboxId",void 0),e.RowSelectorHead=d([t.Component({selector:"mfRowSelectorHead",template:'\n        <input type="checkbox" id="{{checkboxId}}" [checked]="isChecked" (change)="onChange($event)" />\n        <label attr.for="{{checkboxId}}"></label>\n        '}),P("design:paramtypes",[e.DataTable])],e.RowSelectorHead);var y=function(e,t,a,n){var i,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(o<3?i(r):o>3?i(t,a,r):i(t,a))||r);return o>3&&r&&Object.defineProperty(t,a,r),r};e.DataTableModule=function(){function e(){}return e}(),e.DataTableModule=y([t.NgModule({imports:[a.CommonModule],declarations:[e.BootstrapPaginator,e.DataTable,e.DefaultSorter,e.Paginator,e.RowSelector,e.RowSelectorHead],exports:[e.BootstrapPaginator,e.DataTable,e.DefaultSorter,e.Paginator,e.RowSelector,e.RowSelectorHead]})],e.DataTableModule),Object.defineProperty(e,"__esModule",{value:!0})});